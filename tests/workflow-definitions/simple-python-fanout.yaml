---
kind: DataManagerWorkflow
kind-version: "2025.2"
name: python-workflow
description: >-
  A simple parallel workflow. Input is split into N chunks and N processes of the same job is started
variable-mapping:
  inputs:
  - name: candidateMolecules
  outputs:
  - name: clusteredMolecules
    from:
      step: final-step
      output: outputFile


steps:

- name: first-step
  description: Create inputs
  specification:
    collection: workflow-engine-unit-test-jobs
    job: splitsmiles
    version: "1.0.0"
    variables:
      name: "count"
      value: "1"
  inputs:
  - input: inputFile
    from:
      workflow-input: candidateMolecules
  outputs:
  - output: outputFile
    # as: chunk_*.smi

- name: parallel-step
  description: Add some params
  specification:
    collection: workflow-engine-unit-test-jobs
    job: append-col
    version: "1.0.0"
    variables:
      name: "desc1"
      value: "777"
  replicate:
    using:
      input: inputFile
  inputs:
  - input: inputFile
    from:
      step: first-step
      output: outputFile
  outputs:
  - output: outputFile
    # as: parallel-step.out.smi

# - name: final-step
#   description: Collate results
#   specification:
#     collection: workflow-engine-unit-test-jobs
#     job: concatenate
#     version: "1.0.0"
#   inputs:
#   - input: inputFile
#     from:
#       step: parallel-step
#       output: outputFile
#   outputs:
#   - output: outputFile
#     # as: final-step.out.smi
